{
  "previous_attempts": [
    {
      "initial_goal": "пару проблем\n1) при генерации задач контрольной нейронка все еще пихает все в один блок, пусть будет четко минимум три блока может быть много, если тем много, но один пример или вопрос в одном блоке!\n2) тут как и при генерации задач для обычного урока нужен чат с ии, чтобы учитель мог скорректировать и попросить что-то изменить при генерации контроьной\nПожалуйста",
      "solution_summary": "Задача была полностью решена на предыдущем шаге. Были выполнены следующие ключевые изменения:\n1.  **Обновлен AI-сервис (`gemini.service.ts`):** В промпт для генерации контрольных работ добавлены строгие правила по созданию минимум трех блоков (или по одному на каждую тему) с одним упражнением в каждом блоке. Также добавлена поддержка истории чата (`chatHistory`) для интерактивного диалога.\n2.  **Адаптирован бэкенд (`lesson.controller.ts`):** Контроллер теперь принимает `chatHistory` из запроса и передает его в AI-сервис.\n3.  **Расширен API на фронтенде (`lessonApi.ts`):** Мутация для генерации контрольной была обновлена для отправки `chatHistory` на бэкенд.\n4.  **Переработан интерфейс (`ControlWorkContentEditor.tsx`):** Компонент редактора контрольной работы был полностью изменен и теперь включает полноценный интерфейс чата. Учитель может вести диалог с AI, просить внести правки и получать обновленные варианты заданий, что полностью соответствует исходной задаче."
    }
  ]
}